---
created: 2024-03-03
updated: 2024-03-03
Type: knowledge
Status: ⌛️ 等待
tags:
---
## 索引的常见模型
索引实际上可以理解成目录，一种方便快速查询的目录。
但是说到索引，就需要引出一些适合索引查询的数据结构，索引实现方式有很多种，一些特定的数据结构能更好的实现索引的功能，下面简单介绍三种

1.  哈希表
	1.  哈希表是一种以 key-value 的形式存储数据的结构
	2. $ 其优势在于插入的时候很快，同 id 就是往后加链表，所以插入新数据很快
	3. & 劣势在于因为不是有序的，所以做**区间查询**还是要遍历所有的 key，速度很慢
	4. ~ 所以哈希表这种结构只适合于**等值查询**的场景，比如一些 nosql 引擎
2.  有序数组
	1.  而有序数组在等值查询和区间查询的表现都非常优秀
	2. 在等值查询的时候（就是用 key 查 value）可以直接二分法快速查到
	3. 区间查询更是只要选定区间就能查询
	4. & 但是，其缺点在于新增数据的时候，要整体移动插入数据后面的所有数据的位置，新增很慢
	5. ~ 所以有序数组只适用于静态存储引擎，比如 2017 年某个城市人口信息这类不会再变动的数据
3.  二叉树
	1. 二叉树的结构如图![image.png](https://obsidian-pic-1317906728.cos.ap-nanjing.myqcloud.com/obsidian/20240303163256.png)
	2. 他的特点是节点是中间节点，也就是子节点，小于右边的叶子节点，大于左边的叶子节点，他的查询复杂度是 o(logN)，更具体的看[[平衡多路查找树（B树）]]
	3. 树可以二叉，也可以多叉，这个多叉是值每个节点有多个叶子节点，二叉树是搜索效率最高的数据结构
	4. & 但是实际上大多数的数据库存储不使用二叉树，原因在于**索引不止存在内存中，还要写到磁盘上**
		1. ~ 关于这点你可以想想一下，一颗一百万节点的平衡二叉树，树高 20 ，而机械硬盘时代，从磁盘随机读取一个数据块需要 10ms 的寻址时间，而 20 块就是 20 个 10ms，读取的效率过于低下 ![image.png](https://obsidian-pic-1317906728.cos.ap-nanjing.myqcloud.com/obsidian/20240303164041.png)
	5. 所以实际上我们使用的是 N 叉树，这里的 N 取决于数据块的大小，以 InnoDB 的一个整数字段索引为例，这个 N 差不多是 1200。这棵树高是 4 的时候，就可以存 1200 的 3 次方个值，这已经 17 亿了。考虑到树根的数据块总是在内存中的，一个 10 亿行的表上一个整数字段的索引，查找一个值最多只需要访问 3 次磁盘。其实，树的第二层也有很大概率在内存中，那么访问磁盘的平均次数就更少了。

在 mysql 中，索引是在储存引擎层实现的，没有固定的索引标准，而 mysql 中用的最广泛的就是innoDB

## InnoDB 的索引模型

在 innoDB 中

