---
Created: 2024-01-17
Updated: 2024-01-17
Type: knowledge
Status: ğŸƒå·²å®Œæˆ
æˆªæ­¢æ—¥æœŸ: 
ç›®æ ‡: 
é¢†åŸŸ: 
tags:
  - Redisæ“ä½œ
  - RedisList
---


## redis List

- æ˜¯ä»€ä¹ˆï¼šlist
- æ€ä¹ˆç”¨ï¼š
  - åˆ›å»º lpush rpushï¼ˆåˆ†åˆ«æ˜¯å·¦è¾¹å¼€å§‹å¾€é‡Œpushæ•°æ®ï¼Œå’Œå³è¾¹å¼€å§‹å¾€é‡Œpushæ•°æ®ï¼‰
  - æŸ¥è¯¢ llenï¼ˆæŸ¥æœ‰å¤šå°‘ä¸ªï¼‰ lrangeï¼ˆlrange key start stop æŸ¥çœ‹startåˆ°stopä¸ºè§’æ ‡çš„å…ƒç´ ï¼Œå¦‚æœæ˜¯è´Ÿæ•°ï¼Œå°±ä»åé¢å¼€å§‹æŸ¥ï¼‰
  - æ›´æ–° lpush rpush lpopï¼ˆä»å·¦è¾¹å¼€å§‹popï¼‰ rpopï¼ˆåŒç†ï¼‰ lremï¼ˆä»å·¦è¾¹å¼€å§‹removeï¼‰
  - åˆ é™¤ DEl UNLINK

![image-20231217222008380](D:\\study\img\image-20231217222008380.png)

### liståº•å±‚å®ç°

list å¯¹è±¡ç¼–ç ï¼š

1. ziplist ^5f2ba2
	1.  è¦æ»¡è¶³æ¡ä»¶é‡‡ç”¨ziplistç¼–ç ï¼š
		1. åˆ—è¡¨å¯¹è±¡ä¿å­˜çš„æ‰€æœ‰å­—ç¬¦ä¸²é•¿åº¦éƒ½å°äº64å­—èŠ‚
		2. åˆ—è¡¨å¯¹è±¡å…ƒç´ ä¸ªæ•°å°‘äº512ä¸ª

3. linkedlist

4. quickList(ç»¼åˆäº†ä¸Šé¢çš„ä¸¤ä¸ªå®ç°ï¼ŒåŒå‘é“¾è¡¨ï¼Œå†…éƒ¨æ˜¯ziplist)ç›®å‰5.0.5å…¨æ˜¯ç”±quickListå®ç°

   

   linkedlist è¡¨å¤´å®šä¹‰äº†lenï¼Œæ‰€ä»¥æŸ¥è¯¢é•¿åº¦çš„æ—¶é—´å¤æ‚åº¦æ˜¯0ï¼ˆ1ï¼‰

4. listç”±  ç»“æ„å¤´ï¼ˆheaderï¼‰{é‡Œé¢æœ‰ç»“æ„ zllenè®°å½•äº†èŠ‚ç‚¹çš„æ•°é‡ï¼Œä½†æ˜¯å¦‚æœèŠ‚ç‚¹å¤§äº65535,é‚£å°±éœ€è¦éå†äº†ï¼Œå› ä¸ºzllenæ˜¯2å­—èŠ‚çš„ï¼Œåªèƒ½å­˜è¿™ä¹ˆå¤š}   å’Œ æ•°æ®å­—æ®µç»„æˆ

## rediså‹ç¼©åˆ—è¡¨ï¼ˆziplistï¼‰

^2bb21b

	- æ˜¯ä»€ä¹ˆï¼šå†…å­˜ç´§å‡‘çš„åˆ—è¡¨ï¼Œé€‚åˆå°æ•°æ®é‡
	- åœºæ™¯ï¼šlist setï¼Œå°æ•°æ®é‡
	- ä¼˜ç‚¹ï¼šå†…å­˜å ç”¨å°
	- ç¼ºç‚¹æ˜¯ï¼Œæ›´æ–°çš„æ—¶å€™ï¼Œé‡Œé¢çš„æ‰€æœ‰æ•°æ®éƒ½è¦ç§»åŠ¨ï¼Œæ€§èƒ½æˆæœ¬é«˜

å¤–é¢æ˜¯è¡¨å¤´ï¼Œæ•°æ®æŒ‡é’ˆæŒ‡å‘çš„å°±æ˜¯ziplistå®é™…çš„éƒ¨åˆ†äº†
![image.png](https://obsidian-pic-1317906728.cos.ap-nanjing.myqcloud.com/obsidian/20240105002312.png)


![image-20231217232526448](D:\\study\img\image-20231217232526448.png)

zlendè¡¨ç¤ºlistçš„ç»ˆç»“ äºŒè¿›åˆ¶çš„8ä¸ª1ç»„æˆï¼Œä»£è¡¨255

zllen ä¸ºä¸¤ä¸ªå­—èŠ‚é•¿åº¦ï¼Œä¸€èˆ¬æŸ¥æ•°æ®çš„çš„æ—¶å€™ï¼Œzllené‡Œé¢å¯ä»¥å­˜ 2^16æ¬¡æ–¹å‡ä¸€ä½æ•°ï¼Œè¶…è¿‡äº†å°±è¦éå†ï¼Œ==æ‰€ä»¥ä¸€èˆ¬æƒ…å†µä¸‹ï¼ŒæŸ¥è¯¢èŠ‚ç‚¹ä¸ªæ•°çš„æ—¶é—´å¤æ‚åº¦ä¸ºO(1),è¶…è¿‡ä¸€å®šé˜ˆå€¼ï¼Œåˆ™æŸ¥è¯¢èŠ‚ç‚¹çš„å¤æ‚åº¦å°±å˜æˆO(n)== ^1f1cf4

entryè¡¨ç¤ºçš„æ˜¯å®é™…çš„æ•°æ®ï¼Œ

> entry é‡Œé¢ç»“æ„ï¼š prevlen encoding entry-data,åˆ†åˆ«è¡¨ç¤ºï¼Œè®°å½•çš„å‰é¢entryçš„é•¿åº¦ã€ç¼–ç ã€å®é™…æ•°æ®

-  è¿é”æ›´æ–°

  > è¿é”æ›´æ–°å°±æ¶‰åŠåˆ°ä¸Šé¢è¿™ä¸ªprevlenäº†ï¼Œè¿™é‡Œè®°å½•äº†ä¸Šä¸€ä¸ªèŠ‚ç‚¹çš„æ•°æ®é•¿åº¦ï¼Œå¦‚æœå‰ä¸€ä¸ªèŠ‚ç‚¹é•¿åº¦å°äº254å­—èŠ‚ï¼Œé‚£ä¹ˆprevå°±ç”¨1å­—èŠ‚é•¿çš„ç©ºé—´ä¿å­˜è¿™ä¸ªé•¿åº¦ï¼Œå¦åˆ™å°±ç”¨5å­—èŠ‚çš„ç©ºé—´ä¿å­˜è¿™ä¸ªé•¿åº¦
  >
  > è¿™é‡Œå°±å¯èƒ½è§¦å‘è¿é”æ›´æ–°ï¼Œå³prevlenæ›´æ–°é•¿åº¦ä»¥åï¼Œä½¿å¾—æœ¬èŠ‚ç‚¹é•¿åº¦ä¸Šæ¶¨äº†4ä½ï¼Œå†ä½¿å¾—åé¢çš„èŠ‚ç‚¹å†æ›´æ–°prevlen

![image-20231219010107838](D:\\study\img\image-20231219010107838.png)

- æ€ä¹ˆè§£å†³è¿é”æ›´æ–°

  - listpack

    ç»“æ„å˜æˆäº† 

![image-20231219010259819](D:\\study\img\image-20231219010259819.png)

encoding-typeæ˜¯ç¼–ç ç±»å‹

element-dataæ˜¯æ•°æ®å†…å®¹

element-tot-lenå­˜å‚¨æ•´ä¸ªèŠ‚ç‚¹é™¤å®ƒè‡ªèº«ä¹‹å¤–çš„é•¿åº¦
è¿™æ ·ï¼Œå¯ä»¥é€šè¿‡ element-tot-len æ¥è®¡ç®—èŠ‚ç‚¹é•¿åº¦ï¼Œä»è€Œä¸ç”¨ prevlen æ¥ä¿å­˜å‰ä¸€ä¸ªèŠ‚ç‚¹çš„é•¿åº¦

zipListçš„æ›´æ–°
	 ç”±äºzipliståº•å±‚æ˜¯åå‘æ•°ç»„çš„ç»“æ„ï¼Œé‡Œé¢çš„entryä¸ºäº†èŠ‚çº¦å†…å­˜éƒ½æ˜¯ç›¸é‚»çš„ï¼Œè€Œä¸”æ•´ä¸ªziplistçš„å†…å­˜æ˜¯ç»Ÿä¸€åˆ†é…çš„ï¼Œæ‰€ä»¥æ’å…¥æ•°æ®çš„æ—¶å€™ï¼Œä¸»è¦æœ‰ä¸¤ä»¶äº‹
		 1. ä¸ºæ•´ä¸ªziplisté‡æ–°åˆ†é…ç©ºé—´ï¼Œä¸»è¦æ˜¯ä¸ºäº†ç»™æ–°èŠ‚ç‚¹åˆ†é…ç©ºé—´ï¼ˆè¿™ä¸€æ­¥å¦‚æœzipliståˆšå¥½æ²¡æœ‰å¤šä½™ç©ºé—´ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±è¦æŠŠziplistæ•´ä¸ªè¿ç§»åˆ°åˆ«çš„åœ°æ–¹å»ï¼‰
		 2. æ’å…¥èŠ‚ç‚¹,æ’å…¥çš„æ•°æ®åé¢çš„èŠ‚ç‚¹éƒ½è¦å¾€åç§»åŠ¨ï¼Œè…¾å‡ºç©ºé—´ç»™æ–°èŠ‚ç‚¹
	
	 æ‰€ä»¥ï¼Œzipliståœ¨æ•°æ®è¾ƒå¤šçš„æ—¶å€™ï¼ˆæ²¡è¾¾åˆ°è½¬æ¢æˆlinkedListçš„æ ‡å‡†å‰ï¼‰ï¼Œä¼šå¤åˆ¶è¾ƒå¤šçš„ç©ºé—´ï¼Œå¯¼è‡´å¾ˆå¤šå†…å­˜å¤åˆ¶ ^228531
## Linked List

> å¦‚æœä¸æ»¡è¶³zipListçš„æ¡ä»¶ [[#^5f2ba2]]ï¼Œåˆ™ä½¿ç”¨linkedList çš„ç¼–ç 

æ ¼å¼å¦‚ä¸‹

![image.png](https://obsidian-pic-1317906728.cos.ap-nanjing.myqcloud.com/obsidian/20240105002807.png)


è€Œä¸”ï¼ŒlinkedListé‡Œé¢çš„è¡¨å¤´å®šä¹‰äº†é“¾è¡¨åŒ…å«èŠ‚ç‚¹æ•°é‡çš„å­—æ®µ len
	ç»“æ„å¦‚ä¸‹
	![image.png](https://obsidian-pic-1317906728.cos.ap-nanjing.myqcloud.com/obsidian/20240105005306.png)
	æ‰€ä»¥åœ¨linkedListçš„ç¼–ç ä¸‹ï¼ŒæŸ¥è¯¢èŠ‚ç‚¹ä¸ªæ•°çš„å¤æ‚åº¦æ˜¯O(1) ^c4c8df


## quickListæ¨ªç©ºå‡ºä¸–

ä¸Šé¢ä¸¤ä¸ªlistéƒ½å„æœ‰ç¼ºç‚¹ï¼Œziplist åœ¨æ•°æ®æ’å…¥ç¨å¤šçš„æ—¶å€™æ’å…¥æ•°æ®ä¼šå¯¼è‡´å¾ˆå¤šçš„å†…å­˜å¤åˆ¶ï¼ˆåŸå› ï¼‰[[#^228531]] ï¼ŒlinkedListè¡¨ç¨å¾®å¤§ä¸€ç‚¹ï¼ŒèŠ‚ç‚¹æ•°é‡å°±å¾ˆå¤šï¼Œä¼šå¯¼è‡´ä¸å°‘çš„å†…å­˜å ç”¨ï¼Œæ‰€ä»¥ï¼Œåœ¨ ==3.2==ç‰ˆæœ¬ä»¥åï¼Œå°±å¼•å…¥äº†quickListï¼Œ==ä»–æ˜¯é›†äºŒè€…ä¼˜ç‚¹ä¹‹æ•°æ®ç»“æ„==

ä»–çš„æ•°æ®ç»“æ„å¦‚ä¸‹
	![image.png](https://obsidian-pic-1317906728.cos.ap-nanjing.myqcloud.com/obsidian/20240105004503.png)

ä»¥linkedListçš„ç»“æ„ï¼ŒèŠ‚ç‚¹é‡Œé¢å‚¨å­˜çš„æ˜¯ziplistï¼Œå½“æ•°æ®é‡æ¯”è¾ƒå°‘çš„æ—¶å€™ï¼Œä»–åªæœ‰ä¸€ä¸ªèŠ‚ç‚¹ï¼Œç›¸å½“äºä¸€ä¸ªziplistï¼Œæ•°æ®å¾ˆå¤šçš„æ—¶å€™åˆ™æ˜¯åŒæ—¶æ‹¥æœ‰äº†ziplistå’Œlinkedlistçš„ä¼˜ç‚¹
	1. æ•°æ®ä¸ŠèŠ‚çº¦å†…å­˜
	2. æ›´æ–°æé«˜æ›´æ–°æ•ˆç‡

