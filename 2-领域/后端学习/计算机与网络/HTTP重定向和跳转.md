---
created: 2024-02-03
updated: 2024-02-03
Type: knowledge
Status: ⌛️ 等待
tags:
---
## 重定向

关于重定向，有两个（**常用**）状态码要关注 ：
	301 是“永久重定向”，302 是“临时重定向”，浏览器收到这两个状态码就会跳转到新的 URI。

重定向的过程实际是发送了两个请求，比如第一个请求发送了返回 302，第二个请求就会使用 302 跳转到对应的页面

下面是某 302 的返回报文 ![image.png](https://obsidian-pic-1317906728.cos.ap-nanjing.myqcloud.com/obsidian/20240203233621.png)
也就是说，多了一个请求头 Location 

**Location**”字段属于响应字段，必须出现在响应报文里。但只有配合 301⁄302 状态码才有意义，它**标记了服务器要求重定向的 URI**，这里就是要求浏览器跳转到“index.html”。
浏览器收到 301⁄302 报文，会检查响应头里有没有“Location”。如果有，就从字段值里提取出 URI，发出新的 HTTP 请求，相当于自动替我们点击了这个链接。

在“Location”里的 URI 既可以使用**绝对 URI**
	所谓“绝对 URI”，就是完整形式的 URI，包括 scheme、host: port、path 等
也可以使用**相对 URI**
	“相对 URI”，就是省略了 scheme 和 host: port，只有 path 和 query 部分，是不完整的，但可以从请求上下文里计算得到
>[!note]
>如果只是站内跳转是可以用相对 URI 的，但是如果要跳到别的地方就必须绝对 URI，否则浏览器就会当相对 URI 理解

### 重定向状态码
1. **301**俗称“永久重定向”（Moved Permanently），意思是原 URI 已经“永久”性地不存在了，今后的所有请求都必须改用新的 URI，浏览器看到 301，就知道原来的 URI“过时”了，就会做适当的优化。比如历史记录、更新书签，下次可能就会直接用新的 URI 访问，省去了再次跳转的成本。搜索引擎的爬虫看到 301，也会更新索引库，不再使用老的 URI。
2. **302**俗称“临时重定向”（“Moved Temporarily”），意思是原 URI 处于“临时维护”状态，新的 URI 是起“顶包”作用的“临时工”。浏览器或者爬虫看到 302，会认为原来的 URI 仍然有效，但暂时不可用，所以只会执行简单的跳转页面，不记录新的 URI，也不会有其他的多余动作，下次访问还是用原 URI
3.  **303** See Other：类似 302，但要求重定向后的请求改为 GET 方法，访问一个结果页面，避免 POST/PUT 重复操作；
4. **307** Temporary Redirect：类似 302，但重定向后请求里的方法和实体不允许变动，含义比 302 更明确；
5. **308** Permanent Redirect：类似 307，不允许重定向后的请求变动，但它是 301“永久重定向”的含义。

### 应用场景
1. 资源不可用，服务端可以使用这个消息头来告知
2. 增加访问入口，比如申请多个入口，然后转到主站，比如访问 qq. com 就会跳转到 qq 的主站 ![image.png](https://obsidian-pic-1317906728.cos.ap-nanjing.myqcloud.com/obsidian/20240203234710.png)

### 考虑问题
1. 性能问题，毕竟是发送两次请求，所以性能多少有影响
2. 循环跳转，A->B  B->C C->A 这种无限循环，如果重定向的策略设置欠考虑，可能会出现“A=>B=>C=>A”的无限循环，不停地在这个链路里转圈圈，所以 HTTP 协议特别规定，**浏览器必须具有检测“循环跳转”的能力**，在发现这种情况时应当停止发送请求并给出错误提示