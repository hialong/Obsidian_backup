#RedisString #Redis操作
### Redis String 

- 是什么：字符串
- 场景：Json， 二进制，数字字符串
- 限制，最大512M

- 怎么用：
  - 创建：set  setnx(数据已经存在就不会覆盖)

  - 查询: get mget（获取一批）

  - 更新: set

  - 删除: del 

  - set  strniuniu ex 10 (设置string的同时加上过期时间)

    ![image-20231217210935567](D:\study\img\image-20231217210935567.png)

 

### String的底层编码

​	string对象编码有三种

	> redis字符串对象是由redisObject和sdshdr两部分组成的

- INT

    数字之类的用INT，占空间小（只针对整形）

- EMBSTR

  字符串长度比较小的时候用这个编码，有点是，可以一次性分配内存，字节头和内容是在一起的

  > 缺点在于，如果重新分配空间，整体都需要再分配，所以EMBSTR被设置为只读，任何写操作以后，EMBSTR都会变成RAW格式，因为写操作的字符都会被认为是易变的，易变的就用raw更方便更新

- RAW

  字节头和内容是分开的，使用在长的字符串上，字节头和内容是分开的（有个阈值，超过阈值就用这个来存储字符串，目前比较新版本是44（5.0.5））

![image-20231217211908559](C:\Users\92502\AppData\Roaming\Typora\typora-user-images\image-20231217211908559.png)

#### 	关于sdshdr

​	![image-20231217212109893](D:\\study\img\image-20231217212109893.png)

#### 一些面试题

###### 浮点型

​	浮点型在redis中怎么表示的呢，因为int只针对整形，所以，浮点型会转换为对应的字符串，比如3.14-->"3.14"，然后根据长短（阈值44（5.0.5）），用embstr或者raw，long以内的整数就以INT编码存储

###### String大小

​	一个redis字符串最大为512MB，5.0.5里面源码也是直接写死的

###### SDSHDR有什么用

1. redis是c语言写的，sds就是对C语言字符串的封装，自带返回字符串长度，而不需要c语言一样遍历才能得到长度，
2.  而且因为自带长度，所以不需要再以 /0作为结束判断，二进制安全，
3. 有预留空间方便扩展，节约性能

​		

#### String总结

1. 基础操作部分，get  set  setnx，ex加过期时间（==set会覆盖或者擦除过期时间==）
2. 字符串结构
3. 场景：缓存
4. 编码格式：int,embstr,raw（embstr 的只读）
5. SDSHDR：raw的数据指针、优点、预留空间