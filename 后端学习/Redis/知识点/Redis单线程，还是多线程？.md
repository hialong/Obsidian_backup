---
Created: 2024-01-17
Updated: 2024-01-17
Type: knowledge
Status: 🌱 完成
截止日期: 
目标: 
领域: 
Tags:
---


核心处理逻辑一直都是单线程，但是有其他模块比如UNLINK 之类的异步删除操作用的多线程，而6.0以后 网络I/O解包都是多线程
## redis 单线程

6.0后有多线程的IO

- 为什么用单线程 ^f15b30
  1.  快，节约成本  
  2.  redis的性能瓶颈在于IO而不是cpu
  3. 一旦引入多线程，复杂性会大大提升，redis就要实现线程安全，做各种优化，包括上下文切的额外成本（内核成本）


- 为什么单线程还这么快
	redis单线程的性能很好，在普通机器上能有每秒十多万的读性能，几万的写性能 ^d66aec
  - 首先redis是内存数据库，其大部分操作在内存上完成，内存操作本身就特别快
  - redis有高效的数据结构
  - [[IO多路复用#Redis对多路复用的使用]]，使得其能在IO操作中能并发的处理大量的客户端请求，实现高吞吐量

## redis里面一个请求的流程

 1. 读取数据

	1. accept 请求发给redis
	2. recv redis准备好了以后返回，就可以开始下一步
	3. parse 解析数据

 2. 处理数据

    获取一个key

 3. 发送返回包

    send

- redis的读性能能达到10W/s
- 写也能有七八万/s